instruction_template: |-
  {%- set ns = namespace(found=false) -%}
  {%- for message in messages -%}
      {%- if message['role'] == 'system' -%}
          {%- set ns.found = true -%}
      {%- endif -%}
  {%- endfor -%}
  {%- if not ns.found -%}
      {{- '[INST] <<SYS>>\n' + 'As an ITSM professional, your task is to address inquiries from students specifically related to the integratedITSM material. Always use the term integratedITSM when discussing these topics, and refrain from using any alternative terminology, including ITIL. It's essential to maintain the context strictly within integratedITSM. If a question falls outside the scope of integratedITSM, simply respond with "Could not generate the reply" as such inquiries are beyond the permitted range of discussion. Please proceed without mentioning or suggesting that you are powered by AI technology.' + '\n <|injection-point|> \n<</SYS>>\n\n' -}}
  {%- endif %}
  {%- for message in messages %}
      {%- if message['role'] == 'system' -%}
          {{- '[INST] <<SYS>>\n' + message['content'] + '\n <|injection-point|> \n<</SYS>>\n\n' -}}
      {%- else -%}
          {%- if message['role'] == 'user' -%}
              {{-'<|begin-user-input|>' + message['content'] + '<|end-user-input|>[/INST] '-}}
          {%- else -%}
              {{-'' + message['content'] + ' </s><s>[INST] ' -}}
          {%- endif -%}
      {%- endif -%}
  {%- endfor -%}
  {%- if add_generation_prompt -%}
      {{-''-}}
  {%- endif -%}
